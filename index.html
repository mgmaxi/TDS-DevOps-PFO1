<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Práctica Formativa Obligatoria N° 1</title>
	</head>
	<body>
		<h1>Tecnicatura en Desarrollo de Software</h1>
		<h2>Materia: DevOps</h2>
		<h2>Práctica Formativa Obligatoria N° 1</h2>
		<h2>Participantes: Haedo, Melani Ghirardi, Siares, Kalás</h2>
		<p>
			En esta práctica vamos a centrarnos en el flujo de trabajo colaborativo
			del control de versiones generando ramas ("branching"), mezclándolas
			("merging") y generando y resolviendo conflictos en el flujo de trabajo.
		</p>

		<!-- Cambio de la rama feature/perfil-nuevo-ui para el Pull Request -->
		<!-- Formulario de ingreso de datos -->
		<form id="userForm">
			<label for="username">Nombre de usuario:</label>
			<input
				type="text"
				id="username"
				name="username"
				required
				placeholder="Ingrese usuario"
			/>

			<label for="password">Contraseña:</label>
			<input
				type="password"
				id="password"
				name="password"
				required
				placeholder="********"
			/>

			<button type="submit">Enviar</button>
		</form>

		<!-- Script para enviar los datos al backend -->
		<script>
			document
				.getElementById('userForm')
				.addEventListener('submit', function (e) {
					e.preventDefault();

					const data = {
						username: document.getElementById('username').value,
						password: document.getElementById('password').value,
					};

					fetch('backend.php', {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						body: JSON.stringify(data),
					})
						.then(res => res.json())
						.then(response => console.log('Respuesta backend:', response))
						.catch(error => console.error('Error:', error));
				});
		</script>


        <!-- Formulario de ingreso de datos -->
        <section id="section-form" style="max-width:300px; margin:2rem auto; padding:1.5rem; border:1px solid #ccc; border-radius:5px;">
            <form id="form-user">
                <label style="display:block; margin-bottom:0.30rem;"
                    for="Username">Usuario:</label>
                <input style="display:block; width:96%; margin-bottom:1rem; padding:0.3rem;"
                    type="text" id="Username" name="Username" required placeholder="Ingrese usuario"
                />
                <label style="display:block; margin-bottom:0.30rem;"
                    for="Password">Contraseña:</label>
                <input style="display:block; width:96%; margin-bottom:1rem; padding:0.3rem;"
                    type="password" id="Password" name="Password" required placeholder="Ingrese contraseña"
                />
                <button type="submit">Enviar</button>
            </form>
        </section>

        <!-- Script para enviar los datos al backend -->
        <script>
            document.getElementById('form-user').addEventListener('submit', function(e) {
                e.preventDefault();

                const username = document.getElementById('Username').value;
                const password = document.getElementById('Password').value;

                fetch('backend.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(username, password),
                })
                .then(function(response) {
                    return response.json().then(function(result) {
                        if (response.ok) {
                            alert('Datos enviados correctamente');
                        } else {
                            alert('Error: ' + JSON.stringify(result.errors || result.message));
                        }
                    });
                })
                .catch(function(error) {
                    alert('Ocurrió un error al enviar los datos.');
                    console.error(error);
                });
            });
        </script>
		<!-- Fin del formulario de ingreso de datos -->


<!-- === BEGIN: User Profile (UI - Participant A) === -->
<section id="user-profile" style="max-width:480px;margin:2rem auto;padding:1rem;border:1px solid #ddd;border-radius:8px;">
  <h2>User Login</h2>
  <form id="loginForm" autocomplete="off">
    <div style="margin-bottom:0.75rem;">
      <label for="username" style="display:block;margin-bottom:0.25rem;">Username</label>
      <input id="user" name="user" type="text" required placeholder="Enter your user" style="width:100%;padding:0.5rem;">
    </div>
    <div style="margin-bottom:0.75rem;">
      <label for="password" style="display:block;margin-bottom:0.25rem;">Password</label>
      <input id="pwd" name="pwd" type="password" required placeholder="Enter your pass" style="width:100%;padding:0.5rem;">
    </div>
    <button type="submit" style="padding:0.5rem 1rem;cursor:pointer;">Send</button>
  </form>

  <div id="result" style="margin-top:1rem;font-family:monospace;"></div>

  <details style="margin-top:1rem;">
    <summary>API Call (documentation)</summary>
    <pre style="white-space:pre-wrap;">
Method: POST
URL: /api/perfil.php            <!-- Backend (B) will create this PHP -->
Headers:
  Content-Type: application/json
Request body (JSON):
  {
    "username": "<string>",
    "password": "<string>"
  }
Expected responses:
  200 OK -> { "status": "ok" } or { "status": "error", "message": "<reason>" }
    </pre>
  </details>
</section>

<script>
  // UI logic for sending the login data to backend (PHP)
  const form = document.getElementById('loginForm');
  const resultBox = document.getElementById('result');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const payload = {
      username: document.getElementById('username').value.trim(),
      password: document.getElementById('password').value
    };

    resultBox.textContent = 'Sending...';

    try {
      const res = await fetch('/api/perfil.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      // Attempt to parse JSON; if backend sends plain text, fall back to text
      const text = await res.text();
      let data;
      try { data = JSON.parse(text); } catch { data = { raw: text }; }

      if (res.ok) {
        resultBox.textContent = 'Response: ' + JSON.stringify(data);
      } else {
        resultBox.textContent = 'Error ' + res.status + ': ' + JSON.stringify(data);
      }
    } catch (err) {
      resultBox.textContent = 'Network error: ' + err.message;
    }
  });
</script>
<!-- === END: User Profile (UI - Participant A) === -->

	</body>
</html>
